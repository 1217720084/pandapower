

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Run a Power Flow &mdash; pandapower 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="pandapower 1.0 documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pandapower
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About pandapower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elements.html">Datastructure and Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">Topological Searches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networks.html">Generic Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Networks</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">pandapower</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Run a Power Flow</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/pandapower/powerflow/run.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="run-a-power-flow">
<h1>Run a Power Flow<a class="headerlink" href="#run-a-power-flow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ac-power-flow">
<span id="pploadflow"></span><h2>AC Power Flow<a class="headerlink" href="#ac-power-flow" title="Permalink to this headline">¶</a></h2>
<p>A power flow in pandapower is executed by the runpp function. Internally the pandapower power flow is executed with pypower (see <span class="xref std std-ref">about pandapower</span>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are interested in the pypower casefile that pandapower is using for power flow, you can find it in net[&#8220;_mpc_last_cycle&#8221;].
However all necessary informations are written into the pandpower format net, so the pandapower user should not usually have to deal with pypower.</p>
</div>
<dl class="function">
<dt id="pandapower.runpp">
<code class="descclassname">pandapower.</code><code class="descname">runpp</code><span class="sig-paren">(</span><em>net</em>, <em>init='flat'</em>, <em>calculate_voltage_angles=False</em>, <em>tolerance_kva=1e-05</em>, <em>trafo_model='t'</em>, <em>trafo_loading='current'</em>, <em>enforce_q_lims=False</em>, <em>suppress_warnings=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pandapower.runpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs PANDAPOWER AC Flow</p>
<p>Note: May raise pandapower.api.run[&#8220;load&#8221;]flowNotConverged</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><strong>net</strong> - The Pandapower format network</dd>
</dl>
<p>Optional:</p>
<blockquote>
<div><p><strong>init</strong> (str, &#8220;flat&#8221;) - initialization method of the loadflow
Pandapower supports three methods for initializing the loadflow:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;flat&#8221;- flat start with voltage of 1.0pu and angle of 0° at all buses as initial solution</li>
<li>&#8220;dc&#8221; - initial DC loadflow before the AC loadflow. The results of the DC loadflow are used as initial solution for the AC loadflow.</li>
<li>&#8220;results&#8221; - voltage vector of last loadflow from net.res_bus is used as initial solution. This can be useful to accelerate convergence in iterative loadflows like time series calculations.</li>
</ul>
</div></blockquote>
<p><strong>calculate_voltage_angles</strong> (bool, False) - consider voltage angles in loadflow calculation</p>
<blockquote>
<div><p>If True, voltage angles are considered in the  loadflow calculation. In some cases with
large differences in voltage angles (for example in case of transformers with high
voltage shift), the difference between starting and end angle value is very large.
In this case, the loadflow might be slow or it might not converge at all. That is why 
the possibility of neglecting the voltage angles of transformers and ext_grids is
provided to allow and/or accelarate convergence for networks where calculation of 
voltage angles is not necessary. Note that if calculate_voltage_angles is True the
loadflow is initialized with a DC power flow (init = &#8220;dc&#8221;)</p>
<p>The default value is False because pandapower was developed for distribution networks.
Please be aware that this parameter has to be set to True in meshed network for correct
results!</p>
</div></blockquote>
<p><strong>tolerance_kva</strong> (float, 1e-5) - loadflow termination condition referring to P / Q mismatch of node power in kva</p>
<p><strong>trafo_model</strong> (str, &#8220;t&#8221;)  - transformer equivalent circuit model
Pandapower provides two equivalent circuit models for the transformer:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;t&#8221; - transformer is modelled as equivalent with the T-model. This is consistent with PowerFactory and is also more accurate than the PI-model. We recommend using this transformer model.</li>
<li>&#8220;pi&#8221; - transformer is modelled as equivalent PI-model. This is consistent with Sincal, but the method is questionable since the transformer is physically T-shaped. We therefore recommend the use of the T-model.</li>
</ul>
</div></blockquote>
<p><strong>trafo_loading</strong> (str, &#8220;current&#8221;) - mode of calculation for transformer loading</p>
<blockquote>
<div><p>Transformer loading can be calculated relative to the rated current or the rated power. In both cases the overall transformer loading is defined as the maximum loading on the two sides of the transformer.</p>
<ul class="simple">
<li>&#8220;current&#8221;- transformer loading is given as ratio of current flow and rated current of the transformer. This is the recommended setting, since thermal as well as magnetic effects in the transformer depend on the current.</li>
<li>&#8220;power&#8221; - transformer loading is given as ratio of apparent power flow to the rated apparent power of the transformer.</li>
</ul>
</div></blockquote>
<p><strong>enforce_q_lims</strong> (bool, False) - respect generator reactive power limits</p>
<blockquote>
<div>If True, the reactive power limits in net.gen.max_q_kvar/min_q_kvar are respected in the
loadflow. This is done by running a second loadflow if reactive power limits are
violated at any generator, so that the runtime for the loadflow will increase if reactive
power has to be curtailed.</div></blockquote>
<p><strong>suppress_warnings</strong> (bool, True) - suppress warnings in pypower</p>
<blockquote>
<div>If set to True, warnings are disabled during the loadflow. Because of the way data is
processed in pypower, ComplexWarnings are raised during the loadflow. These warnings are
suppressed by this option, however keep in mind all other pypower warnings are also suppressed.</div></blockquote>
<p><strong>**kwargs</strong> - options to use for PYPOWER.runpf</p>
</div></blockquote>
</dd></dl>

<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Neglecting voltage angles is only valid in radial networks! pandapower was developed for distribution networks, which is why omitting the voltage angles is the default.
However be aware that voltage angle differences in networks with multiple galvanically coupled external grids lead to balancing power flows between slack nodes.
That is why voltage angles always have to be considered in meshed network, such as in the sub-transmission level!</p>
</div>
</div>
<div class="section" id="dc-power-flow">
<h2>DC Power flow<a class="headerlink" href="#dc-power-flow" title="Permalink to this headline">¶</a></h2>
<p id="ppdcpf">A DC power flow in pandapower is executed by the rundcpp function. Internally the pandapower power flow is executed with pypower (see <span class="xref std std-ref">about pandapower</span>).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To run an AC power flow with DC power flow initialization, use the AC power flow with init=&#8221;dc&#8221;.</p>
</div>
<dl class="function">
<dt id="pandapower.rundcpp">
<code class="descclassname">pandapower.</code><code class="descname">rundcpp</code><span class="sig-paren">(</span><em>net</em>, <em>trafo_model='t'</em>, <em>trafo_loading='current'</em>, <em>suppress_warnings=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pandapower.rundcpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs PANDAPOWER DC Flow</p>
<p>Note: May raise pandapower.api.run[&#8220;load&#8221;]flowNotConverged</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><strong>net</strong> - The Pandapower format network</dd>
</dl>
<p>Optional:</p>
<blockquote>
<div><p><strong>trafo_model</strong> (str, &#8220;t&#8221;)  - transformer equivalent circuit model
Pandapower provides two equivalent circuit models for the transformer:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;t&#8221; - transformer is modelled as equivalent with the T-model. This is consistent with PowerFactory and is also more accurate than the PI-model. We recommend using this transformer model.</li>
<li>&#8220;pi&#8221; - transformer is modelled as equivalent PI-model. This is consistent with Sincal, but the method is questionable since the transformer is physically T-shaped. We therefore recommend the use of the T-model.</li>
</ul>
</div></blockquote>
<p><strong>trafo_loading</strong> (str, &#8220;current&#8221;) - mode of calculation for transformer loading</p>
<blockquote>
<div><p>Transformer loading can be calculated relative to the rated current or the rated power. In both cases the overall transformer loading is defined as the maximum loading on the two sides of the transformer.</p>
<ul class="simple">
<li>&#8220;current&#8221;- transformer loading is given as ratio of current flow and rated current of the transformer. This is the recommended setting, since thermal as well as magnetic effects in the transformer depend on the current.</li>
<li>&#8220;power&#8221; - transformer loading is given as ratio of apparent power flow to the rated apparent power of the transformer.</li>
</ul>
</div></blockquote>
<p><strong>suppress_warnings</strong> (bool, True) - suppress warnings in pypower</p>
<blockquote>
<div>If set to True, warnings are disabled during the loadflow. Because of the way data is
processed in pypower, ComplexWarnings are raised during the loadflow. These warnings are
suppressed by this option, however keep in mind all other pypower warnings are also suppressed.</div></blockquote>
<p><strong>**kwargs</strong> - options to use for PYPOWER.runpf</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="optimal-power-flow">
<h2>Optimal Power Flow<a class="headerlink" href="#optimal-power-flow" title="Permalink to this headline">¶</a></h2>
<p id="ppopf"><strong>pandapower optimal power flow</strong></p>
<p>The pandapower optimal power flow is the tool for optimizing your grid state. It is reading constraints and costs from the pandapower tables and is processing it into the pypower case file that is handed over to the pypower OPF.
Hitherto we only have a limited set of constraints and cost function options, that is fitting our special use cases. In the future, this module will be developed further in order to allow opf calculations with more felxible cost functions.</p>
<p>You can find the documentation of the pypower OPF under <a class="reference external" href="http://www.pserc.cornell.edu/matpower/manual.pdf">http://www.pserc.cornell.edu/matpower/manual.pdf</a>
In theory, the pandapower OPF can do exactly the same, it just requires an extension of the pandapower &lt;-&gt; pypower interface</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The pandapower OPF is a recent development that is still growing. If you have further requirements you are very welcome to design your own cost functions or use your own solvers.
For coordination, please contact <a class="reference external" href="mailto:friederike&#46;meier&#37;&#52;&#48;uni-kassel&#46;de">friederike<span>&#46;</span>meier<span>&#64;</span>uni-kassel<span>&#46;</span>de</a>
Also we like to discuss future use cases in our weekly meeting.</p>
</div>
<p><strong>Input constraints</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="56%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Parameter</strong></td>
<td><strong>Datatype</strong></td>
<td><strong>Explanation</strong></td>
</tr>
<tr class="row-even"><td>bus.max_vm_pu</td>
<td>float</td>
<td>Maximum voltage</td>
</tr>
<tr class="row-odd"><td>bus.min_vm_pu</td>
<td>float</td>
<td>Minimum voltage</td>
</tr>
<tr class="row-even"><td>sgen.max_p_kw</td>
<td>float</td>
<td>Maximum active ower</td>
</tr>
<tr class="row-odd"><td>sgen.min_p_kw</td>
<td>float</td>
<td>Minimum active power</td>
</tr>
<tr class="row-even"><td>sgen.max_q_kvar</td>
<td>float</td>
<td>Maximum reactive ower</td>
</tr>
<tr class="row-odd"><td>sgen.min_q_kvar</td>
<td>float</td>
<td>Minimum reactive power</td>
</tr>
<tr class="row-even"><td>sgen.controllable</td>
<td>bool</td>
<td>States if sgen is controllable or not, sgen will not be used for optimization if it is not controllable</td>
</tr>
<tr class="row-odd"><td>gen.max_p_kw</td>
<td>float</td>
<td>Maximum active ower</td>
</tr>
<tr class="row-even"><td>gen.min_p_kw</td>
<td>float</td>
<td>Minimum active power</td>
</tr>
<tr class="row-odd"><td>gen.max_q_kvar</td>
<td>float</td>
<td>Maximum reactive ower</td>
</tr>
<tr class="row-even"><td>gen.min_q_kvar</td>
<td>float</td>
<td>Minimum reactive power</td>
</tr>
<tr class="row-odd"><td>gen.controllable</td>
<td>bool</td>
<td>States if a gen is controllable or not. Currently gens must be controllable, because there is no method to respect uncontrollable gens yet.</td>
</tr>
<tr class="row-even"><td>line.max_loading_percent</td>
<td>float</td>
<td>Maximum loading of the line with respect to i_max_ka</td>
</tr>
<tr class="row-odd"><td>trafo.max_loading_percent</td>
<td>float</td>
<td>Maxuimum loading of the transformer with respect to sn_kva and ist corresponding current at 1.0 p.u.</td>
</tr>
</tbody>
</table>
<p><strong>Input Costs</strong></p>
<p>The costs for power can be written into the pandapower tables. They will be used to create the pypower gencost array in the future.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="56%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Parameter</strong></td>
<td><strong>Datatype</strong></td>
<td><strong>Explanation</strong></td>
</tr>
<tr class="row-even"><td>sgen.cost_per_kw</td>
<td>float</td>
<td>currently not used</td>
</tr>
<tr class="row-odd"><td>sgen.cost_per_kvar</td>
<td>float</td>
<td>currently not used</td>
</tr>
<tr class="row-even"><td>gen.cost_per_kw</td>
<td>float</td>
<td>currently not used</td>
</tr>
<tr class="row-odd"><td>gen.cost_per_kvar</td>
<td>float</td>
<td>currently not used</td>
</tr>
</tbody>
</table>
<p><strong>Available cost functions</strong></p>
<p>At the moment we only have the following cost function:</p>
<div class="math">
\[\begin{split}max\{P_G\} \hspace{1cm}\text{subject to:}\hspace{1cm} U_{min} &lt;\ U_B\ &amp;&lt; U_{max}\\
P_{min} &lt;\ P_G\ &amp;&lt; P_{max}\\
Q_{min} &lt;\ Q_G\ &amp;&lt; Q_{max}\\
I_{Branch} &amp;&lt;\ I_{max}\end{split}\]</div>
<p><strong>OPF Output</strong></p>
<p>The result of the OPF are written to the &#8220;official&#8221; pandapower result tables such as res_bus, res_sgen, res_gen etc.
So you find the optimal setting values of the generator in their respective result tables.
Also you can see the resulting voltage and loading values in res_line, res_trafo and res_bus.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 by Fraunhofer IWES and Kassel University.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>